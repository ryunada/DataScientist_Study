[TOC]

# 6. 재구성과 피벗

<details>
  <summary>Reference</summary>
  	Pandas In Action
</details>

- 피벗 테이블 : 열의 값을 집계하고 다른 열의 값을 사용하여 결과를 그룹화
    - 집계 : 여러 값을 요약하는 계산


```python
import pandas as pd
```

## 1. 재구성(Reshaping)
- 기존 형태에서 얻어내기 어려운 정보를 얻을 수 있도록 데이터셋을 다른 형태로 변환하는 것
- 피벗 테이블(Pivot Table) : 큰 데이터셋을 간결한 데이터로 요약하는 방법
- 좁은 데이터셋(Narrow Dataset) == 긴 데이터셋(Long Dataset) == 높은 데이터셋(Tall Dataset)
    - 데이터셋에 값을 추가할 때 데이터셋이 확장되는 방형
- 넓은 데이터셋(Wide Dataset)
    - 값을 추가할수록 가로로 확장되며 너비가 증가하고 좁은/긴/높은 데이터셋은 세로로 확장되며 높이가 증가함

### 1-1. 좁은 데이터셋


```python
pd.DataFrame({'Weekday' : ['Monday','Monday','Tuesday','Tuesday'],
              'City' : ['Miami','New York','Miami','New York'],
              'Temperature' : [100, 65, 105, 70]})
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weekday</th>
      <th>City</th>
      <th>Temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Monday</td>
      <td>Miami</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monday</td>
      <td>New York</td>
      <td>65</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tuesday</td>
      <td>Miami</td>
      <td>105</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tuesday</td>
      <td>New York</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>

- 수직으로 확장됨


```python
pd.DataFrame({'Weekday' : ['Monday','Monday','Monday','Monday','Tuesday','Tuesday','Tuesday','Tuesday'],
              'City' : ['Miami','New York','Chicago','San Francisco','Miami','New York','Chicago','San Francisco'],
              'Temperature' : [100, 65, 50, 60, 105, 70, 58, 62]})
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weekday</th>
      <th>City</th>
      <th>Temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Monday</td>
      <td>Miami</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monday</td>
      <td>New York</td>
      <td>65</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Monday</td>
      <td>Chicago</td>
      <td>50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Monday</td>
      <td>San Francisco</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tuesday</td>
      <td>Miami</td>
      <td>105</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tuesday</td>
      <td>New York</td>
      <td>70</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Tuesday</td>
      <td>Chicago</td>
      <td>58</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Tuesday</td>
      <td>San Francisco</td>
      <td>62</td>
    </tr>
  </tbody>
</table>
</div>

### 1-2. 넓은 데이터셋


```python
pd.DataFrame({'Weekday' : ['Monday','Tuesday'],
              'Miami' : [100, 105],
              'New York' : [65, 75]})
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weekday</th>
      <th>Miami</th>
      <th>New York</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Monday</td>
      <td>100</td>
      <td>65</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tuesday</td>
      <td>105</td>
      <td>75</td>
    </tr>
  </tbody>
</table>
</div>

- 수평으로 확장


```python
pd.DataFrame({'Weekday' : ['Monday','Tuesday'],
              'Miami' : [100, 105],
              'New York' : [65, 75],
              'Chicago' : [50, 58],
              'San Francisco' : [60, 62]})
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weekday</th>
      <th>Miami</th>
      <th>New York</th>
      <th>Chicago</th>
      <th>San Francisco</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Monday</td>
      <td>100</td>
      <td>65</td>
      <td>50</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tuesday</td>
      <td>105</td>
      <td>75</td>
      <td>58</td>
      <td>62</td>
    </tr>
  </tbody>
</table>
</div>

## 2. 피벗 테이블(Pivot Table)
<img src="https://p.ipic.vip/iqmyff.png" width = '80%'>

```python
df.pivot_table(
    valeus = None,
    index = None,        
    columns = None,          
    aggfunc = 'mean',         # 'sum' : 그룹 합계 | 'mean' : 그룹 평균 | 'max' : 그룹에서 가장 큰 값 |etc...
    fill_vale = None,         
    margins = False,          # True : 소계 표시 O | False 소계 표시 X
    margins_name = 'All',
    dropna = True             # True : 결측값 제외 | False : 결측값 제외하지 않음
```
- 피벗 테이블(Pivot Table)
    - 열의 값을 집계하고 다른 열의 값을 사용하여 결과를 그룹화
        - 집계(aggregate) : 여러 값을 요약하는 계산
- Option
    - values : 집계할 열
    - index : 행 인덱스로 설정할 데이터
    - columns : 열 인덱스로 설정할 데이터
    - aggfunc : 집계 함수
    - <details>
        <summary>Reference</summary>
        	Pandas In Action
      </details>
    
    - margins : 소계 표시 여부
    - margins_name : 소계 명
    - dropna : 결측값 제거
- Process  
    I. 값을 집계할 열을 선택  
    II. 열에 적용할 집계 연산을 선택  
    III. 값이 집계된 데이터를 범주로 그룹화할 열을 선택  
    IV. 그룹을 행 축, 열 축 또는 두 축 모두에 배치할지 여부를 결정함  


```python
sales = pd.read_csv('./Data/sales_by_employee.csv')
sales
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Customer</th>
      <th>Revenue</th>
      <th>Expenses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/1/20</td>
      <td>Oscar</td>
      <td>Logistics XYZ</td>
      <td>5250</td>
      <td>531</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/1/20</td>
      <td>Oscar</td>
      <td>Money Corp.</td>
      <td>4406</td>
      <td>661</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/2/20</td>
      <td>Oscar</td>
      <td>PaperMaven</td>
      <td>8661</td>
      <td>1401</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/3/20</td>
      <td>Oscar</td>
      <td>PaperGenius</td>
      <td>7075</td>
      <td>906</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1/4/20</td>
      <td>Oscar</td>
      <td>Paper Pound</td>
      <td>2524</td>
      <td>1767</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1/5/20</td>
      <td>Oscar</td>
      <td>Paper Pound</td>
      <td>2793</td>
      <td>624</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1/1/20</td>
      <td>Michael</td>
      <td>Logistics XYZ</td>
      <td>7172</td>
      <td>412</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1/2/20</td>
      <td>Michael</td>
      <td>PaperGenius</td>
      <td>6362</td>
      <td>685</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1/3/20</td>
      <td>Michael</td>
      <td>PaperGenius</td>
      <td>5982</td>
      <td>1772</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1/4/20</td>
      <td>Michael</td>
      <td>Best Paper Co.</td>
      <td>7917</td>
      <td>1857</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1/5/20</td>
      <td>Michael</td>
      <td>Best Paper Co.</td>
      <td>7837</td>
      <td>1633</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1/1/20</td>
      <td>Jim</td>
      <td>PaperGenius</td>
      <td>1864</td>
      <td>1305</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1/2/20</td>
      <td>Jim</td>
      <td>Money Corp.</td>
      <td>8278</td>
      <td>462</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1/3/20</td>
      <td>Jim</td>
      <td>Paper Pound</td>
      <td>4226</td>
      <td>1923</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1/4/20</td>
      <td>Jim</td>
      <td>PaperMaven</td>
      <td>3868</td>
      <td>1889</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1/4/20</td>
      <td>Jim</td>
      <td>Average Paper Co.</td>
      <td>2287</td>
      <td>426</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1/1/20</td>
      <td>Dwight</td>
      <td>PaperGenius</td>
      <td>2639</td>
      <td>368</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1/3/20</td>
      <td>Dwight</td>
      <td>Logistics XYZ</td>
      <td>4951</td>
      <td>758</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1/3/20</td>
      <td>Dwight</td>
      <td>Best Paper Co.</td>
      <td>2703</td>
      <td>1321</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1/3/20</td>
      <td>Dwight</td>
      <td>Logistics XYZ</td>
      <td>4258</td>
      <td>1202</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1/5/20</td>
      <td>Dwight</td>
      <td>Paper Pound</td>
      <td>7771</td>
      <td>1475</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1/1/20</td>
      <td>Creed</td>
      <td>Money Corp.</td>
      <td>4430</td>
      <td>548</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1/2/20</td>
      <td>Creed</td>
      <td>Average Paper Co.</td>
      <td>8026</td>
      <td>1906</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1/2/20</td>
      <td>Creed</td>
      <td>Average Paper Co.</td>
      <td>5188</td>
      <td>1768</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1/4/20</td>
      <td>Creed</td>
      <td>PaperMaven</td>
      <td>3144</td>
      <td>1314</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1/5/20</td>
      <td>Creed</td>
      <td>Money Corp.</td>
      <td>938</td>
      <td>1053</td>
    </tr>
  </tbody>
</table>
</div>


```python
sales.pivot_table(
    index = 'Date',           # 행 인덱스 : 'Date'
    columns = 'Name',         # 열 인덱스 : 'Name'
    aggfunc = 'sum',          # 집계함수 : 합계로
    values = 'Revenue',       # 집계할 값 : 'Revenue'
    fill_value = 0,           # 결측값(NaN/null) : 0
    margins = True,           # 소계 표시 O
    margins_name = 'Total'    # 소계 명 : 'Total'
)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Name</th>
      <th>Creed</th>
      <th>Dwight</th>
      <th>Jim</th>
      <th>Michael</th>
      <th>Oscar</th>
      <th>Total</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1/1/20</th>
      <td>4430</td>
      <td>2639</td>
      <td>1864</td>
      <td>7172</td>
      <td>9656</td>
      <td>25761</td>
    </tr>
    <tr>
      <th>1/2/20</th>
      <td>13214</td>
      <td>0</td>
      <td>8278</td>
      <td>6362</td>
      <td>8661</td>
      <td>36515</td>
    </tr>
    <tr>
      <th>1/3/20</th>
      <td>0</td>
      <td>11912</td>
      <td>4226</td>
      <td>5982</td>
      <td>7075</td>
      <td>29195</td>
    </tr>
    <tr>
      <th>1/4/20</th>
      <td>3144</td>
      <td>0</td>
      <td>6155</td>
      <td>7917</td>
      <td>2524</td>
      <td>19740</td>
    </tr>
    <tr>
      <th>1/5/20</th>
      <td>938</td>
      <td>7771</td>
      <td>0</td>
      <td>7837</td>
      <td>2793</td>
      <td>19339</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>21726</td>
      <td>22322</td>
      <td>20523</td>
      <td>35270</td>
      <td>30709</td>
      <td>130550</td>
    </tr>
  </tbody>
</table>
</div>


```python
sales.pivot_table(
    index = 'Date',           # 행 인덱스 : 'Date'
    columns = 'Name',         # 열 인덱스 : 'Name'
    aggfunc = ['max','min'],  # 집계함수 : 최대값, 최소값
    values = 'Revenue',       # 집계할 값 : 'Revenue'
    fill_value = 0,           # 결측값(NaN/null) : 0
    margins = True,           # 소계 표시 O
    margins_name = 'Total'    # 소계 명 : 'Total'
)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead tr th {
        text-align: left;
    }
    
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">max</th>
      <th colspan="6" halign="left">min</th>
    </tr>
    <tr>
      <th>Name</th>
      <th>Creed</th>
      <th>Dwight</th>
      <th>Jim</th>
      <th>Michael</th>
      <th>Oscar</th>
      <th>Total</th>
      <th>Creed</th>
      <th>Dwight</th>
      <th>Jim</th>
      <th>Michael</th>
      <th>Oscar</th>
      <th>Total</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1/1/20</th>
      <td>4430</td>
      <td>2639</td>
      <td>1864</td>
      <td>7172</td>
      <td>5250</td>
      <td>7172</td>
      <td>4430</td>
      <td>2639</td>
      <td>1864</td>
      <td>7172</td>
      <td>4406</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>1/2/20</th>
      <td>8026</td>
      <td>0</td>
      <td>8278</td>
      <td>6362</td>
      <td>8661</td>
      <td>8661</td>
      <td>5188</td>
      <td>0</td>
      <td>8278</td>
      <td>6362</td>
      <td>8661</td>
      <td>5188</td>
    </tr>
    <tr>
      <th>1/3/20</th>
      <td>0</td>
      <td>4951</td>
      <td>4226</td>
      <td>5982</td>
      <td>7075</td>
      <td>7075</td>
      <td>0</td>
      <td>2703</td>
      <td>4226</td>
      <td>5982</td>
      <td>7075</td>
      <td>2703</td>
    </tr>
    <tr>
      <th>1/4/20</th>
      <td>3144</td>
      <td>0</td>
      <td>3868</td>
      <td>7917</td>
      <td>2524</td>
      <td>7917</td>
      <td>3144</td>
      <td>0</td>
      <td>2287</td>
      <td>7917</td>
      <td>2524</td>
      <td>2287</td>
    </tr>
    <tr>
      <th>1/5/20</th>
      <td>938</td>
      <td>7771</td>
      <td>0</td>
      <td>7837</td>
      <td>2793</td>
      <td>7837</td>
      <td>938</td>
      <td>7771</td>
      <td>0</td>
      <td>7837</td>
      <td>2793</td>
      <td>938</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>8026</td>
      <td>7771</td>
      <td>8278</td>
      <td>7917</td>
      <td>8661</td>
      <td>8661</td>
      <td>938</td>
      <td>2639</td>
      <td>1864</td>
      <td>5982</td>
      <td>2524</td>
      <td>938</td>
    </tr>
  </tbody>
</table>
</div>

## 3. Stack & UnStack


```python
by_name_and_date = sales.pivot_table(
    index = 'Name',
    columns = 'Date',
    values = 'Revenue',
    aggfunc = 'sum'
)
by_name_and_date
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Date</th>
      <th>1/1/20</th>
      <th>1/2/20</th>
      <th>1/3/20</th>
      <th>1/4/20</th>
      <th>1/5/20</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Creed</th>
      <td>4430.0</td>
      <td>13214.0</td>
      <td>NaN</td>
      <td>3144.0</td>
      <td>938.0</td>
    </tr>
    <tr>
      <th>Dwight</th>
      <td>2639.0</td>
      <td>NaN</td>
      <td>11912.0</td>
      <td>NaN</td>
      <td>7771.0</td>
    </tr>
    <tr>
      <th>Jim</th>
      <td>1864.0</td>
      <td>8278.0</td>
      <td>4226.0</td>
      <td>6155.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Michael</th>
      <td>7172.0</td>
      <td>6362.0</td>
      <td>5982.0</td>
      <td>7917.0</td>
      <td>7837.0</td>
    </tr>
    <tr>
      <th>Oscar</th>
      <td>9656.0</td>
      <td>8661.0</td>
      <td>7075.0</td>
      <td>2524.0</td>
      <td>2793.0</td>
    </tr>
  </tbody>
</table>
</div>

### 3-1 .인덱스 레벨을 열 축으로 이동 :: df.stack( )
- 인덱스 레벨을 열 축에서 행 축으로 이동


```python
by_name_and_date.stack().head()
```


    Name    Date  
    Creed   1/1/20     4430.0
            1/2/20    13214.0
            1/4/20     3144.0
            1/5/20      938.0
    Dwight  1/1/20     2639.0
    dtype: float64

### 3-2. 인덱스 레벨을 행축으로 이동 :: df.unstack( )
- 인덱스 레벨을 행 축에서 열 축으로 이동


```python
by_name_and_date.unstack().head()
```


    Date    Name   
    1/1/20  Creed      4430.0
            Dwight     2639.0
            Jim        1864.0
            Michael    7172.0
            Oscar      9656.0
    dtype: float64

## 4. 피벗 해제(Melting)
<img src = "https://p.ipic.vip/w6avea.png" width = "50%">

```python
df.melt(
    id_vars = None,
    value_vars = None,
    var_name = None,
    value_name = None,
)
```
- 넓은 데이터셋을 좁은 데이터셋으로 변환하는 과정
    - 즉, 열 데이터를 행 데이터로 변환
- Option
    - id_vars : 식별자 변수로 사용할 열
    - value_vars : 피벗을 해제할 열
    - var_name : '변수'열에 사용할 이름
    - value_name : '값'에 사용할 이름


```python
video_game_sales = pd.read_csv('./Data/video_game_sales.csv')
video_game_sales
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>NA</th>
      <th>EU</th>
      <th>JP</th>
      <th>Other</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wii Sports</td>
      <td>41.49</td>
      <td>29.02</td>
      <td>3.77</td>
      <td>8.46</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>29.08</td>
      <td>3.58</td>
      <td>6.81</td>
      <td>0.77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mario Kart Wii</td>
      <td>15.85</td>
      <td>12.88</td>
      <td>3.79</td>
      <td>3.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wii Sports Resort</td>
      <td>15.75</td>
      <td>11.01</td>
      <td>3.28</td>
      <td>2.96</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>11.27</td>
      <td>8.89</td>
      <td>10.22</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16561</th>
      <td>Woody Woodpecker in Crazy Castle 5</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>16562</th>
      <td>Men in Black II: Alien Escape</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>16563</th>
      <td>SCORE International Baja 1000: The Official Game</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>16564</th>
      <td>Know How 2</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>16565</th>
      <td>Spirits &amp; Spells</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>16566 rows × 5 columns</p>
</div>


```python
video_game_sales.columns[1:]
```


    Index(['NA', 'EU', 'JP', 'Other'], dtype='object')


```python
video_game_sales.melt(
    id_vars = 'Name', 
    value_vars = video_game_sales.columns[1:],
    var_name = 'Region',
    value_name = 'Sales',
)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Region</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wii Sports</td>
      <td>NA</td>
      <td>41.49</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>NA</td>
      <td>29.08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mario Kart Wii</td>
      <td>NA</td>
      <td>15.85</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wii Sports Resort</td>
      <td>NA</td>
      <td>15.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>NA</td>
      <td>11.27</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>66259</th>
      <td>Woody Woodpecker in Crazy Castle 5</td>
      <td>Other</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>66260</th>
      <td>Men in Black II: Alien Escape</td>
      <td>Other</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>66261</th>
      <td>SCORE International Baja 1000: The Official Game</td>
      <td>Other</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>66262</th>
      <td>Know How 2</td>
      <td>Other</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>66263</th>
      <td>Spirits &amp; Spells</td>
      <td>Other</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>66264 rows × 3 columns</p>
</div>

## 5. 리스트 형태의 값 전개 :: df.explode( )
```python
df.explode(
    column,
    ignore_index = False
)
```
- 리스트 형태의 값을 여러 행으로 전개
- Option
    - column : 전개할 리스트 형태의 열
    - ignore_index : 기존 인덱스 무시 여부


```python
recipes = pd.read_csv('./Data/recipes.csv')
recipes
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recipe</th>
      <th>Ingredients</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cashew Crusted Chicken</td>
      <td>Apricot preserves, Dijon mustard, curry powder...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tomato Basil Salmon</td>
      <td>Salmon filets, basil, tomato, olive oil, Parme...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parmesan Cheese Chicken</td>
      <td>Bread crumbs, Parmesan cheese, Italian seasoni...</td>
    </tr>
  </tbody>
</table>
</div>


```python
recipes['Ingredients'] = recipes['Ingredients'].str.split(',')
```


```python
recipes.explode('Ingredients')
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recipe</th>
      <th>Ingredients</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cashew Crusted Chicken</td>
      <td>Apricot preserves</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Cashew Crusted Chicken</td>
      <td>Dijon mustard</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Cashew Crusted Chicken</td>
      <td>curry powder</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Cashew Crusted Chicken</td>
      <td>chicken breasts</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Cashew Crusted Chicken</td>
      <td>cashews</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tomato Basil Salmon</td>
      <td>Salmon filets</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tomato Basil Salmon</td>
      <td>basil</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tomato Basil Salmon</td>
      <td>tomato</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tomato Basil Salmon</td>
      <td>olive oil</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tomato Basil Salmon</td>
      <td>Parmesan cheese</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parmesan Cheese Chicken</td>
      <td>Bread crumbs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parmesan Cheese Chicken</td>
      <td>Parmesan cheese</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parmesan Cheese Chicken</td>
      <td>Italian seasoning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parmesan Cheese Chicken</td>
      <td>egg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Parmesan Cheese Chicken</td>
      <td>chicken breasts</td>
    </tr>
  </tbody>
</table>
</div>
